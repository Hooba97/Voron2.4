[include mainsail.cfg]
[include moonraker_obico_macros.cfg]
[include neo.cfg]
[include macros.cfg]
[include motors.cfg]

[virtual_sdcard]
path: ~/printer_data/gcodes
[display_status]
[pause_resume]


[exclude_object]

[mcu]
serial: /dev/serial/by-id/usb-Klipper_stm32h723xx_24000E000951313339373836-if00
[mcu CB2]
serial: /tmp/klipper_host_mcu

#####################################################################
# 	EBB
#####################################################################

[mcu EBB]
serial: /dev/serial/by-id/usb-Klipper_rp2040_504434031095121C-if00

[temperature_sensor EBB_NTC]
sensor_type: Generic 3950
sensor_pin: EBB:gpio27

[lis2dw]
cs_pin: EBB:gpio1
spi_bus: spi0a
axes_map: z,x,y

[resonance_tester]
probe_points: 100, 100, 20
accel_chip: lis2dw

#####################################################################
# 	EDDY
#####################################################################

[mcu eddy]
serial: /dev/serial/by-id/usb-Klipper_rp2040_50443403102B461C-if00
restart_method: command
#Did you read all of the comments before the macros? Make sure that you do and then uncomment the ones that you need. Remove this line when you are done.

[temperature_sensor btt_eddy_mcu]
sensor_type: temperature_mcu
sensor_mcu: eddy 
min_temp: 10 
max_temp: 100 

[probe_eddy_current btt_eddy]
sensor_type: ldc1612
z_offset: 2.5
#i2c_address:
i2c_mcu: eddy
i2c_bus: i2c0f
x_offset: 0
y_offset: 21.42

[temperature_probe btt_eddy]
sensor_type: Generic 3950
sensor_pin: eddy:gpio26
horizontal_move_z: 2

[bed_mesh]
horizontal_move_z: 2
speed: 200
mesh_min: 25, 31.42 
mesh_max: 325, 325
#mesh_max: 287.5, 290
probe_count: 9, 9
algorithm: bicubic
scan_overshoot: 8  #uncomment this section if you still have room left over on the X axis for some scan overshoot to product smoother movements and more accurate scanning. Uncommenting this should be fine if you are using a standard voron mount.

[safe_z_home]
home_xy_position: 175, 175
z_hop: 10
z_hop_speed: 25
speed: 200

[save_variables]
filename: ~/printer_data/config/variables.cfg

[force_move]
enable_force_move: True



#####################################################################
# 	MAIN
#####################################################################

[printer]
kinematics: corexy
max_velocity: 300  
max_accel: 3000 
max_z_velocity: 15 			#Max 15 for 12V TMC Drivers, can increase for 24V


#max_velocity: 500  
#max_accel: 25000    			#Max 4000
#max_z_velocity: 30 			#Max 15 for 12V TMC Drivers, can increase for 24V
max_z_accel: 350
square_corner_velocity: 5.0

[temperature_sensor MCU]
sensor_type: temperature_mcu

[temperature_sensor SoC]
sensor_type: temperature_host



#####################################################################
# 	Bed Heater
#####################################################################

[heater_bed]
heater_pin: PA0
sensor_type: ATC Semitec 104GT-2
#sensor_type: EPCOS 100K B57560G104F
#Generic 3950
sensor_pin: PB1
max_power: 1.0
min_temp: 0
max_temp: 120
#control: pid
#pid_kp: 58.437
#pid_ki: 2.347
#pid_kd: 363.769


#####################################################################
# 	Homing and Gantry Adjustment Routines
#####################################################################

[idle_timeout]
timeout: 1800

[quad_gantry_level]
##	Use QUAD_GANTRY_LEVEL to level a gantry.
##	Min & Max gantry corners - measure from nozzle at MIN (0,0) and 
##	MAX (250, 250), (300,300), or (350,350) depending on your printer size
##	to respective belt positions

gantry_corners:
	-60,-10
	410,420
#	Probe points
points:
	50,25
	50,275
	300,275
	300,25
    
#gantry_corners:
#	-80,-55
#	390,375
#points:
#	57.5,10
#	57.5,200
#	247.5,200
#	247.5,10
speed: 150
horizontal_move_z: 10
retries: 5
retry_tolerance: 0.0075
max_adjust: 10

[board_pins]
aliases:
    # EXP1 header
    EXP1_1=PE7, EXP1_2=PG1,
    EXP1_3=PG0, EXP1_4=PF15,
    EXP1_5=PF14, EXP1_6=PF13,    # Slot in the socket on this side
    EXP1_7=PF12, EXP1_8=PF11,
    EXP1_9=<GND>, EXP1_10=<5V>,

    # EXP2 header
    EXP2_1=PE13, EXP2_2=PE12,
    EXP2_3=PE15, EXP2_4=PE11,
    EXP2_5=PE10, EXP2_6=PE14,      # Slot in the socket on this side
    EXP2_7=PE8, EXP2_8=<RST>,
    EXP2_9=<GND>, EXP2_10=<NC>

[fan] # fan1
pin: EBB:gpio14



[heater_fan hotend_fan] # fan2
pin: EBB:gpio4
heater: extruder
heater_temp: 50.0


[controller_fan motor_driver_fan]
pin: PF7
kick_start_time: 0.5
#cycle_time: 0.1  # Optional for better low-speed performance
stepper: stepper_x, stepper_y, stepper_z, extruder  # List all motors to monitor
idle_timeout: 10  # Time in seconds to keep the fan running after motors are idle
max_power: 0.75

#*# <---------------------- SAVE_CONFIG ---------------------->
#*# DO NOT EDIT THIS BLOCK OR BELOW. The contents are auto-generated.
#*#
#*# [probe_eddy_current btt_eddy]
#*# reg_drive_current = 15
#*# calibrate =
#*# 	0.050000:3167747.386,0.090000:3167225.329,0.130000:3166731.093,
#*# 	0.170000:3166234.918,0.210000:3165746.335,0.250000:3165271.981,
#*# 	0.290000:3164810.608,0.330000:3164350.008,0.370000:3163912.994,
#*# 	0.410000:3163447.131,0.450000:3163023.759,0.490000:3162578.717,
#*# 	0.530000:3162135.054,0.570000:3161733.707,0.610000:3161337.032,
#*# 	0.650000:3160925.470,0.690000:3160532.926,0.730000:3160140.347,
#*# 	0.770000:3159730.315,0.810000:3159370.750,0.850000:3159011.046,
#*# 	0.890000:3158627.653,0.930000:3158271.335,0.970000:3157920.649,
#*# 	1.010000:3157572.087,1.050000:3157247.018,1.090000:3156913.387,
#*# 	1.130000:3156581.230,1.170000:3156256.398,1.210000:3155950.094,
#*# 	1.250000:3155614.428,1.290000:3155307.833,1.330000:3155012.476,
#*# 	1.370000:3154710.855,1.410000:3154409.088,1.450000:3154135.680,
#*# 	1.490000:3153870.389,1.530000:3153591.052,1.570000:3153340.654,
#*# 	1.610000:3153058.890,1.650000:3152790.876,1.690000:3152542.491,
#*# 	1.730000:3152292.656,1.770000:3152040.984,1.810000:3151789.284,
#*# 	1.850000:3151550.306,1.890000:3151303.659,1.930000:3151062.014,
#*# 	1.970000:3150841.062,2.010000:3150621.058,2.050000:3150393.954,
#*# 	2.090000:3150153.447,2.130000:3149955.104,2.170000:3149725.059,
#*# 	2.210000:3149518.338,2.250000:3149301.039,2.290000:3149099.801,
#*# 	2.330000:3148911.542,2.370000:3148705.086,2.410000:3148524.020,
#*# 	2.450000:3148332.705,2.490000:3148139.538,2.530000:3147939.744,
#*# 	2.570000:3147762.982,2.610000:3147611.722,2.650000:3147416.609,
#*# 	2.690000:3147240.672,2.730000:3147068.126,2.770000:3146899.352,
#*# 	2.810000:3146724.008,2.850000:3146558.572,2.890000:3146381.162,
#*# 	2.930000:3146222.960,2.970000:3146081.634,3.010000:3145931.599,
#*# 	3.050000:3145755.704,3.090000:3145626.673,3.130000:3145468.776,
#*# 	3.170000:3145318.501,3.210000:3145175.431,3.250000:3145017.981,
#*# 	3.290000:3144917.054,3.330000:3144760.223,3.370000:3144623.142,
#*# 	3.410000:3144503.259,3.450000:3144370.934,3.490000:3144231.787,
#*# 	3.530000:3144111.144,3.570000:3143974.785,3.610000:3143874.425,
#*# 	3.650000:3143728.755,3.690000:3143611.332,3.730000:3143502.632,
#*# 	3.770000:3143370.509,3.810000:3143256.299,3.850000:3143146.755,
#*# 	3.890000:3143030.067,3.930000:3142915.230,3.970000:3142808.522,
#*# 	4.010000:3142711.177,4.050000:3142592.120
#*#
#*# [extruder]
#*# control = pid
#*# pid_kp = 16.396
#*# pid_ki = 0.834
#*# pid_kd = 80.544
#*#
#*# [input_shaper]
#*# shaper_type_x = mzv
#*# shaper_freq_x = 52.8
#*# shaper_type_y = mzv
#*# shaper_freq_y = 38.8
#*#
#*# [bed_mesh default]
#*# version = 1
#*# points =
#*# 	  0.224021, 0.210777, 0.196808, 0.183213, 0.198155, 0.211536, 0.230913, 0.259862, 0.271088
#*# 	  0.223011, 0.206083, 0.192576, 0.185459, 0.186234, 0.193761, 0.205543, 0.229513, 0.248714
#*# 	  0.217345, 0.199826, 0.170470, 0.166346, 0.167780, 0.184472, 0.195913, 0.204504, 0.218557
#*# 	  0.204786, 0.187667, 0.161688, 0.152895, 0.150404, 0.155141, 0.167564, 0.181488, 0.186733
#*# 	  0.201317, 0.187118, 0.156611, 0.152991, 0.150406, 0.149509, 0.165019, 0.177708, 0.186698
#*# 	  0.219290, 0.201481, 0.154741, 0.147307, 0.153444, 0.159202, 0.166960, 0.179356, 0.185819
#*# 	  0.220648, 0.196813, 0.179994, 0.173529, 0.162429, 0.161330, 0.177891, 0.193672, 0.183001
#*# 	  0.236442, 0.225140, 0.196201, 0.188249, 0.187502, 0.196649, 0.206037, 0.213079, 0.224498
#*# 	  0.241669, 0.220192, 0.209620, 0.207612, 0.222869, 0.232506, 0.238653, 0.252210, 0.253987
#*# x_count = 9
#*# y_count = 9
#*# mesh_x_pps = 2
#*# mesh_y_pps = 2
#*# algo = bicubic
#*# tension = 0.2
#*# min_x = 25.0
#*# max_x = 325.0
#*# min_y = 31.42
#*# max_y = 324.94
#*#
#*# [heater_bed]
#*# control = pid
#*# pid_kp = 62.776
#*# pid_ki = 3.948
#*# pid_kd = 249.536
#*#
#*# [temperature_probe btt_eddy]
#*# calibration_temp = 42.109947
#*# drift_calibration =
#*# 	3177096.075794, -398.690726, 3.628569
#*# 	3169212.484715, -303.061625, 2.594020
#*# 	3162726.434895, -218.997201, 1.653965
#*# 	3157623.224764, -155.628985, 0.937876
#*# 	3153601.899004, -111.150383, 0.440234
#*# 	3150382.135163, -80.784194, 0.118591
#*# 	3147835.761911, -60.639103, -0.084777
#*# 	3145323.792801, -20.722001, -0.573697
#*# 	3143614.743638, -9.585134, -0.677973
#*# drift_calibration_min_temp = 25.64001698597323
