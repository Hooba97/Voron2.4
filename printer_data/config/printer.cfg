[include mainsail.cfg]
[include moonraker_obico_macros.cfg]
[include neo.cfg]
[include macros.cfg]
[include motors.cfg]

[mcu]
serial: /dev/serial/by-id/usb-Klipper_stm32h723xx_24000E000951313339373836-if00
[mcu CB2]
serial: /tmp/klipper_host_mcu

#####################################################################
# 	EBB
#####################################################################

[mcu EBB]
serial: /dev/serial/by-id/usb-Klipper_rp2040_504434031095121C-if00

[temperature_sensor EBB_NTC]
sensor_type: Generic 3950
sensor_pin: EBB:gpio27

[lis2dw]
cs_pin: EBB:gpio1
spi_bus: spi0a
axes_map: z,x,y

[resonance_tester]
probe_points: 100, 100, 20
accel_chip: lis2dw

#####################################################################
# 	EDDY
#####################################################################

[mcu eddy]
serial: /dev/serial/by-id/usb-Klipper_rp2040_50443403102B461C-if00
restart_method: command
#Did you read all of the comments before the macros? Make sure that you do and then uncomment the ones that you need. Remove this line when you are done.

[temperature_sensor btt_eddy_mcu]
sensor_type: temperature_mcu # Sets the type of sensor for Klipper to read
sensor_mcu: eddy # Sets the MCU of the eddy probe tempereature sensor
min_temp: 10 # Sets the minimum tempereature for eddys tempereature sensor to operate
max_temp: 100 # Sets the maximum tempereature for eddys tempereature sensor to operate

[probe_eddy_current btt_eddy]
sensor_type: ldc1612
z_offset: 2.5
#i2c_address:
i2c_mcu: eddy
i2c_bus: i2c0f
x_offset: 0
y_offset: 21.42

[temperature_probe btt_eddy]
sensor_type: Generic 3950
sensor_pin: eddy:gpio26
horizontal_move_z: 2

[bed_mesh]
horizontal_move_z: 2
speed: 150
mesh_min: 15, 21.42 
mesh_max: 335, 335
#mesh_max: 287.5, 290
probe_count: 9, 9
algorithm: bicubic
#scan_overshoot: 8  #uncomment this section if you still have room left over on the X axis for some scan overshoot to product smoother movements and more accurate scanning. Uncommenting this should be fine if you are using a standard voron mount.

[safe_z_home]
home_xy_position: 170, 170 
z_hop: 10
z_hop_speed: 25
speed: 200

[save_variables]
filename: ~/printer_data/config/variables.cfg

[force_move]
enable_force_move: True



#####################################################################
# 	MAIN
#####################################################################

[printer]
kinematics: corexy
max_velocity: 300  
max_accel: 3000 
max_z_velocity: 15 			#Max 15 for 12V TMC Drivers, can increase for 24V


#max_velocity: 500  
#max_accel: 25000    			#Max 4000
#max_z_velocity: 30 			#Max 15 for 12V TMC Drivers, can increase for 24V
max_z_accel: 350
square_corner_velocity: 5.0

[temperature_sensor MCU]
sensor_type: temperature_mcu

[temperature_sensor SoC]
sensor_type: temperature_host




#####################################################################
# 	Bed Heater
#####################################################################

[heater_bed]
heater_pin: PA0
sensor_type: ATC Semitec 104GT-2
#sensor_type: EPCOS 100K B57560G104F
#Generic 3950
sensor_pin: PB1
max_power: 1.0
min_temp: 0
max_temp: 120
#control: pid
#pid_kp: 58.437
#pid_ki: 2.347
#pid_kd: 363.769


#####################################################################
# 	Homing and Gantry Adjustment Routines
#####################################################################

[idle_timeout]
timeout: 1800

[quad_gantry_level]
##	Use QUAD_GANTRY_LEVEL to level a gantry.
##	Min & Max gantry corners - measure from nozzle at MIN (0,0) and 
##	MAX (250, 250), (300,300), or (350,350) depending on your printer size
##	to respective belt positions

gantry_corners:
	-60,-10
	410,420
#	Probe points
points:
	50,25
	50,275
	300,275
	300,25
    
#gantry_corners:
#	-80,-55
#	390,375
#points:
#	57.5,10
#	57.5,200
#	247.5,200
#	247.5,10
speed: 150
horizontal_move_z: 10
retries: 5
retry_tolerance: 0.0075
max_adjust: 10

[board_pins]
aliases:
    # EXP1 header
    EXP1_1=PE7, EXP1_2=PG1,
    EXP1_3=PG0, EXP1_4=PF15,
    EXP1_5=PF14, EXP1_6=PF13,    # Slot in the socket on this side
    EXP1_7=PF12, EXP1_8=PF11,
    EXP1_9=<GND>, EXP1_10=<5V>,

    # EXP2 header
    EXP2_1=PE13, EXP2_2=PE12,
    EXP2_3=PE15, EXP2_4=PE11,
    EXP2_5=PE10, EXP2_6=PE14,      # Slot in the socket on this side
    EXP2_7=PE8, EXP2_8=<RST>,
    EXP2_9=<GND>, EXP2_10=<NC>

[fan] # fan1
pin: EBB:gpio14



[heater_fan hotend_fan] # fan2
pin: EBB:gpio4
heater: extruder
heater_temp: 50.0


[controller_fan motor_driver_fan]
pin: PF7
kick_start_time: 0.5
#cycle_time: 0.1  # Optional for better low-speed performance
stepper: stepper_x, stepper_y, stepper_z, extruder  # List all motors to monitor
idle_timeout: 10  # Time in seconds to keep the fan running after motors are idle
max_power: 0.75

#*# <---------------------- SAVE_CONFIG ---------------------->
#*# DO NOT EDIT THIS BLOCK OR BELOW. The contents are auto-generated.
#*#
#*# [probe_eddy_current btt_eddy]
#*# reg_drive_current = 15
#*# calibrate =
#*# 	0.050000:3168341.455,0.090000:3167787.788,0.130000:3167296.413,
#*# 	0.170000:3166796.729,0.210000:3166311.883,0.250000:3165809.419,
#*# 	0.290000:3165323.562,0.330000:3164868.912,0.370000:3164397.299,
#*# 	0.410000:3163943.678,0.450000:3163508.877,0.490000:3163065.486,
#*# 	0.530000:3162620.860,0.570000:3162196.492,0.610000:3161802.303,
#*# 	0.650000:3161367.033,0.690000:3161019.302,0.730000:3160578.672,
#*# 	0.770000:3160198.417,0.810000:3159823.436,0.850000:3159428.219,
#*# 	0.890000:3159077.661,0.930000:3158695.250,0.970000:3158349.277,
#*# 	1.010000:3157999.874,1.050000:3157663.725,1.090000:3157307.148,
#*# 	1.130000:3156970.621,1.170000:3156662.442,1.210000:3156366.438,
#*# 	1.250000:3156065.174,1.290000:3155739.491,1.330000:3155437.781,
#*# 	1.370000:3155148.280,1.410000:3154836.080,1.450000:3154562.794,
#*# 	1.490000:3154253.966,1.530000:3153962.575,1.570000:3153709.631,
#*# 	1.610000:3153433.802,1.650000:3153185.656,1.690000:3152910.471,
#*# 	1.730000:3152645.275,1.770000:3152430.761,1.810000:3152166.503,
#*# 	1.850000:3151888.745,1.890000:3151687.104,1.930000:3151454.117,
#*# 	1.970000:3151207.656,2.010000:3150975.199,2.050000:3150742.640,
#*# 	2.090000:3150511.272,2.130000:3150299.602,2.170000:3150101.675,
#*# 	2.210000:3149880.681,2.250000:3149677.854,2.290000:3149460.930,
#*# 	2.330000:3149261.331,2.370000:3149069.030,2.410000:3148866.836,
#*# 	2.450000:3148679.897,2.490000:3148478.834,2.530000:3148286.117,
#*# 	2.570000:3148112.029,2.610000:3147931.565,2.650000:3147740.711,
#*# 	2.690000:3147588.361,2.730000:3147385.934,2.770000:3147219.753,
#*# 	2.810000:3147060.669,2.850000:3146884.103,2.890000:3146728.788,
#*# 	2.930000:3146549.943,2.970000:3146407.284,3.010000:3146251.870,
#*# 	3.050000:3146094.535,3.090000:3145935.300,3.130000:3145786.666,
#*# 	3.170000:3145673.679,3.210000:3145519.649,3.250000:3145390.909,
#*# 	3.290000:3145228.055,3.330000:3145071.181,3.370000:3144954.292,
#*# 	3.410000:3144811.936,3.450000:3144687.363,3.490000:3144537.725,
#*# 	3.530000:3144409.871,3.570000:3144309.542,3.610000:3144160.600,
#*# 	3.650000:3144045.629,3.690000:3143922.659,3.730000:3143805.889,
#*# 	3.770000:3143688.863,3.810000:3143564.944,3.850000:3143462.386,
#*# 	3.890000:3143340.666,3.930000:3143236.157,3.970000:3143105.507,
#*# 	4.010000:3143037.094,4.050000:3142920.356
#*#
#*# [temperature_probe btt_eddy]
#*# calibration_temp = 28.183516
#*# drift_calibration =
#*# 	3167528.438196, -57.136585, -0.487441
#*# 	3161793.988027, -38.713586, -0.532900
#*# 	3157007.058789, -12.940558, -0.762985
#*# 	3153096.885661, 6.916526, -0.916158
#*# 	3149678.524709, 36.823697, -1.232012
#*# 	3147045.863258, 51.746484, -1.372743
#*# 	3145121.116657, 51.105859, -1.330934
#*# 	3143620.152098, 45.631042, -1.240673
#*# 	3141988.328793, 59.990127, -1.392004
#*# drift_calibration_min_temp = 28.981599508903052
#*#
#*# [extruder]
#*# control = pid
#*# pid_kp = 16.396
#*# pid_ki = 0.834
#*# pid_kd = 80.544
#*#
#*# [input_shaper]
#*# shaper_type_x = 2hump_ei
#*# shaper_freq_x = 71.8
#*# shaper_type_y = mzv
#*# shaper_freq_y = 35.4
#*#
#*# [bed_mesh default]
#*# version = 1
#*# points =
#*# 	  0.000589, 0.125526, 0.096875, 0.080392, 0.084386, 0.098739, 0.116310, 0.156405, 0.179533
#*# 	  0.012382, 0.107414, 0.078901, 0.064055, 0.065436, 0.069318, 0.095999, 0.110001, 0.135045
#*# 	  0.019681, 0.108583, 0.065342, 0.040320, 0.040068, 0.045284, 0.069963, 0.075917, 0.097795
#*# 	  0.027137, 0.084849, 0.054545, 0.034847, 0.028921, 0.022516, 0.039043, 0.041629, 0.056113
#*# 	  0.037512, 0.074682, 0.053137, 0.025714, 0.032586, 0.026123, 0.040116, 0.029080, 0.054392
#*# 	  0.050483, 0.097386, 0.059503, 0.043899, 0.035094, 0.038810, 0.051283, 0.048909, 0.060793
#*# 	  0.066291, 0.102855, 0.068953, 0.053251, 0.052764, 0.047244, 0.060129, 0.065407, 0.072275
#*# 	  0.102912, 0.123676, 0.086276, 0.082552, 0.075887, 0.082991, 0.098223, 0.111839, 0.119459
#*# 	  0.040272, 0.053249, 0.040119, 0.027374, 0.033959, 0.053269, 0.087599, 0.100173, 0.107169
#*# x_count = 9
#*# y_count = 9
#*# mesh_x_pps = 2
#*# mesh_y_pps = 2
#*# algo = bicubic
#*# tension = 0.2
#*# min_x = 15.0
#*# max_x = 335.0
#*# min_y = 21.42
#*# max_y = 334.94
#*#
#*# [heater_bed]
#*# control = pid
#*# pid_kp = 62.776
#*# pid_ki = 3.948
#*# pid_kd = 249.536
