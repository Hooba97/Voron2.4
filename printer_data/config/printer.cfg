[include mainsail.cfg]
[include moonraker_obico_macros.cfg]
[include neo.cfg]
[include macros.cfg]
[include motors.cfg]

[exclude_object]

[mcu]
serial: /dev/serial/by-id/usb-Klipper_stm32h723xx_24000E000951313339373836-if00
[mcu CB2]
serial: /tmp/klipper_host_mcu

#####################################################################
# 	EBB
#####################################################################

[mcu EBB]
serial: /dev/serial/by-id/usb-Klipper_rp2040_504434031095121C-if00

[temperature_sensor EBB_NTC]
sensor_type: Generic 3950
sensor_pin: EBB:gpio27

[lis2dw]
cs_pin: EBB:gpio1
spi_bus: spi0a
axes_map: z,x,y

[resonance_tester]
probe_points: 100, 100, 20
accel_chip: lis2dw

#####################################################################
# 	EDDY
#####################################################################

[mcu eddy]
serial: /dev/serial/by-id/usb-Klipper_rp2040_50443403102B461C-if00
restart_method: command
#Did you read all of the comments before the macros? Make sure that you do and then uncomment the ones that you need. Remove this line when you are done.

[temperature_sensor btt_eddy_mcu]
sensor_type: temperature_mcu # Sets the type of sensor for Klipper to read
sensor_mcu: eddy # Sets the MCU of the eddy probe tempereature sensor
min_temp: 10 # Sets the minimum tempereature for eddys tempereature sensor to operate
max_temp: 100 # Sets the maximum tempereature for eddys tempereature sensor to operate

[probe_eddy_current btt_eddy]
sensor_type: ldc1612
z_offset: 2.5
#i2c_address:
i2c_mcu: eddy
i2c_bus: i2c0f
x_offset: 0
y_offset: 21.42

[temperature_probe btt_eddy]
sensor_type: Generic 3950
sensor_pin: eddy:gpio26
horizontal_move_z: 2

[bed_mesh]
horizontal_move_z: 2
speed: 150
mesh_min: 25, 31.42 
mesh_max: 325, 325
#mesh_max: 287.5, 290
probe_count: 9, 9
algorithm: bicubic
scan_overshoot: 8  #uncomment this section if you still have room left over on the X axis for some scan overshoot to product smoother movements and more accurate scanning. Uncommenting this should be fine if you are using a standard voron mount.

[safe_z_home]
home_xy_position: 170, 170 
z_hop: 10
z_hop_speed: 25
speed: 200

[save_variables]
filename: ~/printer_data/config/variables.cfg

[force_move]
enable_force_move: True



#####################################################################
# 	MAIN
#####################################################################

[printer]
kinematics: corexy
max_velocity: 500  
max_accel: 4000 
max_z_velocity: 15 			#Max 15 for 12V TMC Drivers, can increase for 24V


#max_velocity: 500  
#max_accel: 25000    			#Max 4000
#max_z_velocity: 30 			#Max 15 for 12V TMC Drivers, can increase for 24V
max_z_accel: 350
square_corner_velocity: 5.0

[temperature_sensor MCU]
sensor_type: temperature_mcu

[temperature_sensor SoC]
sensor_type: temperature_host




#####################################################################
# 	Bed Heater
#####################################################################

[heater_bed]
heater_pin: PA0
sensor_type: ATC Semitec 104GT-2
#sensor_type: EPCOS 100K B57560G104F
#Generic 3950
sensor_pin: PB1
max_power: 1.0
min_temp: 0
max_temp: 120
#control: pid
#pid_kp: 58.437
#pid_ki: 2.347
#pid_kd: 363.769


#####################################################################
# 	Homing and Gantry Adjustment Routines
#####################################################################

[idle_timeout]
timeout: 1800

[quad_gantry_level]
##	Use QUAD_GANTRY_LEVEL to level a gantry.
##	Min & Max gantry corners - measure from nozzle at MIN (0,0) and 
##	MAX (250, 250), (300,300), or (350,350) depending on your printer size
##	to respective belt positions

gantry_corners:
	-60,-10
	410,420
#	Probe points
points:
	50,25
	50,275
	300,275
	300,25
    
#gantry_corners:
#	-80,-55
#	390,375
#points:
#	57.5,10
#	57.5,200
#	247.5,200
#	247.5,10
speed: 150
horizontal_move_z: 10
retries: 5
retry_tolerance: 0.0075
max_adjust: 10

[board_pins]
aliases:
    # EXP1 header
    EXP1_1=PE7, EXP1_2=PG1,
    EXP1_3=PG0, EXP1_4=PF15,
    EXP1_5=PF14, EXP1_6=PF13,    # Slot in the socket on this side
    EXP1_7=PF12, EXP1_8=PF11,
    EXP1_9=<GND>, EXP1_10=<5V>,

    # EXP2 header
    EXP2_1=PE13, EXP2_2=PE12,
    EXP2_3=PE15, EXP2_4=PE11,
    EXP2_5=PE10, EXP2_6=PE14,      # Slot in the socket on this side
    EXP2_7=PE8, EXP2_8=<RST>,
    EXP2_9=<GND>, EXP2_10=<NC>

[fan] # fan1
pin: EBB:gpio14



[heater_fan hotend_fan] # fan2
pin: EBB:gpio4
heater: extruder
heater_temp: 50.0


[controller_fan motor_driver_fan]
pin: PF7
kick_start_time: 0.5
#cycle_time: 0.1  # Optional for better low-speed performance
stepper: stepper_x, stepper_y, stepper_z, extruder  # List all motors to monitor
idle_timeout: 10  # Time in seconds to keep the fan running after motors are idle
max_power: 0.75

#*# <---------------------- SAVE_CONFIG ---------------------->
#*# DO NOT EDIT THIS BLOCK OR BELOW. The contents are auto-generated.
#*#
#*# [probe_eddy_current btt_eddy]
#*# reg_drive_current = 15
#*# calibrate =
#*# 	0.050000:3169602.904,0.090000:3169020.662,0.130000:3168518.594,
#*# 	0.170000:3167977.243,0.210000:3167480.640,0.250000:3166947.557,
#*# 	0.290000:3166451.724,0.330000:3165960.550,0.370000:3165485.927,
#*# 	0.410000:3165001.493,0.450000:3164534.403,0.490000:3164068.125,
#*# 	0.530000:3163621.871,0.570000:3163185.859,0.610000:3162759.192,
#*# 	0.650000:3162316.832,0.690000:3161889.624,0.730000:3161493.230,
#*# 	0.770000:3161092.559,0.810000:3160679.571,0.850000:3160287.449,
#*# 	0.890000:3159917.741,0.930000:3159517.484,0.970000:3159153.489,
#*# 	1.010000:3158783.072,1.050000:3158435.384,1.090000:3158075.252,
#*# 	1.130000:3157730.430,1.170000:3157360.679,1.210000:3157048.464,
#*# 	1.250000:3156721.564,1.290000:3156380.132,1.330000:3156082.941,
#*# 	1.370000:3155782.719,1.410000:3155487.215,1.450000:3155188.179,
#*# 	1.490000:3154869.383,1.530000:3154576.709,1.570000:3154313.177,
#*# 	1.610000:3154006.771,1.650000:3153745.642,1.690000:3153474.673,
#*# 	1.730000:3153230.288,1.770000:3152938.752,1.810000:3152675.300,
#*# 	1.850000:3152420.556,1.890000:3152178.327,1.930000:3151936.619,
#*# 	1.970000:3151657.017,2.010000:3151432.139,2.050000:3151188.297,
#*# 	2.090000:3150954.765,2.130000:3150743.464,2.170000:3150518.543,
#*# 	2.210000:3150256.213,2.250000:3150068.278,2.290000:3149859.505,
#*# 	2.330000:3149653.779,2.370000:3149415.177,2.410000:3149234.356,
#*# 	2.450000:3149014.750,2.490000:3148837.197,2.530000:3148635.809,
#*# 	2.570000:3148419.250,2.610000:3148237.433,2.650000:3148050.565,
#*# 	2.690000:3147870.514,2.730000:3147711.500,2.770000:3147526.630,
#*# 	2.810000:3147345.457,2.850000:3147168.067,2.890000:3147012.919,
#*# 	2.930000:3146847.692,2.970000:3146678.654,3.010000:3146515.798,
#*# 	3.050000:3146328.730,3.090000:3146187.717,3.130000:3146005.552,
#*# 	3.170000:3145881.926,3.210000:3145736.750,3.250000:3145577.590,
#*# 	3.290000:3145430.278,3.330000:3145303.500,3.370000:3145133.266,
#*# 	3.410000:3145016.970,3.450000:3144881.040,3.490000:3144747.766,
#*# 	3.530000:3144624.318,3.570000:3144479.213,3.610000:3144353.122,
#*# 	3.650000:3144242.065,3.690000:3144099.305,3.730000:3143978.115,
#*# 	3.770000:3143872.999,3.810000:3143742.746,3.850000:3143604.070,
#*# 	3.890000:3143497.667,3.930000:3143387.383,3.970000:3143269.527,
#*# 	4.010000:3143146.380,4.050000:3143045.066
#*#
#*# [extruder]
#*# control = pid
#*# pid_kp = 16.396
#*# pid_ki = 0.834
#*# pid_kd = 80.544
#*#
#*# [input_shaper]
#*# shaper_type_x = 2hump_ei
#*# shaper_freq_x = 71.8
#*# shaper_type_y = mzv
#*# shaper_freq_y = 35.4
#*#
#*# [bed_mesh default]
#*# version = 1
#*# points =
#*# 	0.136549, 0.099778, 0.066555, 0.047957, 0.055583, 0.050723, 0.066578, 0.083121, 0.105403
#*# 	0.136656, 0.090606, 0.059017, 0.041374, 0.033295, 0.035821, 0.047729, 0.058747, 0.073405
#*# 	0.110643, 0.084558, 0.048145, 0.016306, 0.014954, 0.014525, 0.026064, 0.035578, 0.046120
#*# 	0.108656, 0.063170, 0.033113, 0.014489, 0.003735, -0.004856, 0.004995, 0.015778, 0.025935
#*# 	0.095081, 0.059738, 0.038419, 0.016030, 0.002426, 0.004139, 0.005592, 0.020462, 0.025973
#*# 	0.106425, 0.066704, 0.044491, 0.031945, 0.016243, 0.020580, 0.027817, 0.025417, 0.037692
#*# 	0.112491, 0.078542, 0.044685, 0.040505, 0.036152, 0.031206, 0.047225, 0.048679, 0.053074
#*# 	0.132765, 0.095417, 0.070324, 0.062560, 0.061088, 0.066025, 0.071908, 0.077846, 0.082479
#*# 	0.132874, 0.096895, 0.095104, 0.087548, 0.092522, 0.117552, 0.137596, 0.141420, 0.156777
#*# x_count = 9
#*# y_count = 9
#*# mesh_x_pps = 2
#*# mesh_y_pps = 2
#*# algo = bicubic
#*# tension = 0.2
#*# min_x = 25.0
#*# max_x = 325.0
#*# min_y = 31.42
#*# max_y = 324.94
#*#
#*# [heater_bed]
#*# control = pid
#*# pid_kp = 62.776
#*# pid_ki = 3.948
#*# pid_kd = 249.536
#*#
#*# [temperature_probe btt_eddy]
#*# calibration_temp = 24.009974
